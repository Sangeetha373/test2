<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RecipeRecommender+</title>

<style>
:root {
    --primary:#27ae60;
    --veg:#2ecc71;
    --nonveg:#e74c3c;
    --bg:#f4f6f8;
}
body {
    margin:0;
    font-family:'Segoe UI',sans-serif;
    background:var(--bg);
}
.container {
    max-width:1100px;
    margin:auto;
    padding:20px;
}
header {
    text-align:center;
    margin-bottom:25px;
}
header h1 { margin:0; color:#2c3e50; }
header p { color:#7f8c8d; }

.search-area {
    background:#fff;
    padding:25px;
    border-radius:16px;
    box-shadow:0 6px 18px rgba(0,0,0,.06);
    margin-bottom:30px;
}
.controls {
    display:flex;
    gap:12px;
    flex-wrap:wrap;
}
input, select {
    padding:15px;
    border:2px solid #ddd;
    border-radius:10px;
    font-size:16px;
}
input { flex:2; min-width:240px; }
select { flex:1; min-width:160px; cursor:pointer; }
button {
    padding:15px 35px;
    background:var(--primary);
    border:none;
    border-radius:10px;
    color:#fff;
    font-weight:bold;
    cursor:pointer;
    transition:.3s;
}
button:hover { background:#219150; transform:translateY(-1px); }

.loader {
    display:none;
    text-align:center;
    padding:30px;
    font-weight:bold;
    color:#7f8c8d;
}

.results-grid {
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
    gap:22px;
}

.card {
    background:#fff;
    border-radius:14px;
    overflow:hidden;
    box-shadow:0 5px 14px rgba(0,0,0,.07);
    border-bottom:5px solid transparent;
    transition:.3s;
}
.card:hover { transform:translateY(-4px); }

.card img {
    width:100%;
    height:180px;
    object-fit:cover;
}

.card-content { padding:16px; }

.badge {
    font-size:11px;
    padding:4px 9px;
    border-radius:6px;
    font-weight:bold;
    display:inline-block;
    margin-bottom:8px;
}
.veg { background:#eafaf1; color:var(--veg); }
.nonveg { background:#fdecea; color:var(--nonveg); }

.match {
    font-size:13px;
    color:#555;
    margin:8px 0;
}
.bar {
    height:6px;
    background:#eee;
    border-radius:3px;
}
.fill {
    height:100%;
    background:var(--veg);
    border-radius:3px;
}

.view-btn {
    display:inline-block;
    margin-top:10px;
    font-size:14px;
    font-weight:bold;
    color:#2980b9;
    cursor:pointer;
    text-decoration:none;
}

/* Modal */
.modal {
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.6);
    align-items:center;
    justify-content:center;
}
.modal-box {
    background:#fff;
    width:90%;
    max-width:600px;
    max-height:85vh;
    overflow:auto;
    padding:25px;
    border-radius:16px;
}
.close {
    float:right;
    cursor:pointer;
    font-size:20px;
    font-weight:bold;
}
</style>
</head>

<body>

<div class="container">
<header>
    <h1>üçΩÔ∏è RecipeRecommender+</h1>
    <p>Smart ingredient-based recipe suggestions</p>
</header>

<div class="search-area">
    <div class="controls">
        <input id="userInput" placeholder="Ingredients (e.g. potato, onion)">
        <select id="dietType">
            <option value="all">All</option>
            <option value="veg">Veg Only</option>
            <option value="nonveg">Non-Veg Only</option>
        </select>
        <button onclick="getRecipes()">Search</button>
    </div>
</div>

<div id="loader" class="loader">üîç Finding best matches‚Ä¶</div>
<div id="results" class="results-grid"></div>
</div>

<!-- Modal -->
<div id="modal" class="modal">
<div class="modal-box">
<span class="close" onclick="closeModal()">‚úñ</span>
<div id="modalContent"></div>
</div>
</div>

<script>
document.getElementById("userInput").addEventListener("keypress",e=>{
    if(e.key==="Enter") getRecipes();
});

const nonVegKeywords=["chicken","beef","mutton","lamb","pork","fish","egg","seafood","goat","shrimp"];

async function getRecipes(){
    const input=document.getElementById("userInput").value.trim().toLowerCase();
    const diet=document.getElementById("dietType").value;
    const loader=document.getElementById("loader");
    const results=document.getElementById("results");

    if(!input) return alert("Please enter ingredients");

    loader.style.display="block";
    results.innerHTML="";

    const ingredients=input.split(",").map(i=>i.trim());

    try{
        const res=await fetch(`https://www.themealdb.com/api/json/v1/1/filter.php?i=${ingredients[0]}`);
        const data=await res.json();

        if(!data.meals){
            results.innerHTML="<p>No recipes found.</p>";
            return;
        }

        const details=await Promise.all(
            data.meals.slice(0,12).map(m=>
                fetch(`https://www.themealdb.com/api/json/v1/1/lookup.php?i=${m.idMeal}`)
                .then(r=>r.json())
            )
        );

        details.forEach(d=>{
            const meal=d.meals[0];
            const allText=(JSON.stringify(meal)).toLowerCase();
            const isNonVeg=nonVegKeywords.some(k=>allText.includes(k));

            if(diet==="veg" && isNonVeg) return;
            if(diet==="nonveg" && !isNonVeg) return;

            let matchCount=ingredients.filter(i=>allText.includes(i)).length;
            let matchPercent=Math.min(100,Math.floor((matchCount/ingredients.length)*100)+40);

            renderCard(meal,isNonVeg,matchPercent);
        });

    }catch{
        results.innerHTML="<p>Error fetching data.</p>";
    }finally{
        loader.style.display="none";
    }
}

function renderCard(meal,isNonVeg,match){
    const results=document.getElementById("results");
    const card=document.createElement("div");
    card.className="card";
    card.style.borderBottomColor=isNonVeg?"var(--nonveg)":"var(--veg)";

    card.innerHTML=`
        <img src="${meal.strMealThumb}">
        <div class="card-content">
            <span class="badge ${isNonVeg?"nonveg":"veg"}">${isNonVeg?"Non-Veg":"Veg"}</span>
            <h3>${meal.strMeal}</h3>
            <div class="match">Match: ${match}%</div>
            <div class="bar"><div class="fill" style="width:${match}%"></div></div>
            <a class="view-btn" onclick="openModal('${meal.idMeal}')">View Recipe ‚Üí</a>
        </div>
    `;
    results.appendChild(card);
}

async function openModal(id){
    const modal=document.getElementById("modal");
    const box=document.getElementById("modalContent");
    modal.style.display="flex";

    const res=await fetch(`https://www.themealdb.com/api/json/v1/1/lookup.php?i=${id}`);
    const data=await res.json();
    const m=data.meals[0];

    let ingredients="";
    for(let i=1;i<=20;i++){
        if(m["strIngredient"+i])
            ingredients+=`<li>${m["strIngredient"+i]} - ${m["strMeasure"+i]}</li>`;
    }

    box.innerHTML=`
        <h2>${m.strMeal}</h2>
        <h4>Ingredients</h4>
        <ul>${ingredients}</ul>
        <h4>Instructions</h4>
        <p>${m.strInstructions}</p>
        ${m.strYoutube?`<a href="${m.strYoutube}" target="_blank">‚ñ∂ Watch Video</a>`:""}
    `;
}

function closeModal(){
    document.getElementById("modal").style.display="none";
}
</script>

</body>
</html>
